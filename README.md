# Noir Swift

**NoirSwift** is a Swift package for generating and verifying [Noir](https://noir-lang.org/) zero-knowledge proofs using the Barretenberg backend.

The Swift bindings are generated by the [**mopro CLI**](https://zkmopro.org/docs/getting-started) using the **Noir adapter**, which relies on a prebuilt Barretenberg backend.

To learn more about the original Rust implementation before generating bindings, please refer to [noir-rs](https://github.com/zkmopro/noir-rs).

## How to Import the Package

### Option 1: Using Xcode

1. Open your project in Xcode.

2. Go to **File > Add package dependencies**.

3. In _Search or Enter Package URL_, enter the URL: `https://github.com/zkmopro/NoirSwift`

4. Choose the version and add the package to your project.

### Option 2: Using `Package.swift`

Add the following to your `Package.swift` dependencies:

```swift
let package = Package(
    name: "YourSwiftProject",
    products: [
        //...
    ],
    dependencies: [
        .package(url: "https://github.com/zkmopro/NoirSwift", from: "1.0.0-beta.8")
    ],
    // ...
    targets: [
        .target(
            name: "YourSwiftProject",
            dependencies: [
                .product(name: "NoirSwift", package: "NoirSwift")
            ]
        ),
    ]
)
```

### Option 3: Using CocoaPods

1. Add the following to your `Podfile`:

```pod
pod 'NoirSwift', :git => 'https://github.com/zkmopro/NoirSwift.git', :branch => 'main'
```

2. Run the installation command:

```sh
pod install
```

## How to Use the Package

Here is an example of how to integrate and use this package.<br/>
For the full test implementation, see [Tests/NoirSwiftTests/NoirSwiftTests.swift](Tests/NoirSwiftTests/NoirSwiftTests.swift).

### Import the package

```swift
import NoirSwift
```

### Load circuit and srs

Please checkout [noir-rs](https://github.com/zkmopro/noir-rs) to see how to generate the circuit and the srs.

```swift
let noirCircuitPath = Bundle.main.path(
    forResource: "noir_multiplier2",
    ofType: "json"
)!

let noirSrsPath = Bundle.module.path(
    forResource: "noir_multiplier2",
    ofType: "srs"
)!
```

### `getNoirVerificationKey`

```swift
let onChain = true
let lowMemoryMode = false
let inputs = ["3", "5"]

let vk = try getNoirVerificationKey(
    circuitPath: noirCircuitPath,
    srsPath: noirSrsPath,
    onChain: onChain,
    lowMemoryMode: lowMemoryMode
)
```

### `generateNoirProof`

```swift
let proofData = try generateNoirProof(
    circuitPath: noirCircuitPath,
    srsPath: noirSrsPath,
    inputs: inputs,
    onChain: onChain,
    vk: vk,
    lowMemoryMode: lowMemoryMode
)
```

### `verifyNoirProof`

```swift
let isValid = try verifyNoirProof(
    circuitPath: noirCircuitPath,
    proof: proofData,
    onChain: onChain,
    vk: vk,
    lowMemoryMode: lowMemoryMode
)
```

## How to Build the Package

1. Use `mopro-cli` and choose `noir`

```sh
mopro init
```

choose `noir`

```sh
mopro build
```

choose `ios` and all architectures.

2. Zip the `MoproiOSBindings/MoproBindings.xcframework`

```sh
cd MoproiOSBindings
zip -r NoirBindings.xcframework.zip MoproBindings.xcframework
```

3. Compute the checksum

```sh
swift package compute-checksum NoirBindings.xcframework.zip
```

4. Upload the `NoirBindings.xcframework.zip` to some URL

5. Update `Sources/mopro.swift` file with `MoproiOSBindings/mopro.swift`

## Test the package

```sh
xcodebuild test \
  -scheme NoirSwift \
  -destination 'platform=iOS Simulator,name=iPhone 17 Pro,OS=latest'
```

## Community

-   X account: <a href="https://twitter.com/zkmopro"><img src="https://img.shields.io/twitter/follow/zkmopro?style=flat-square&logo=x&label=zkmopro"></a>
-   Telegram group: <a href="https://t.me/zkmopro"><img src="https://img.shields.io/badge/telegram-@zkmopro-blue.svg?style=flat-square&logo=telegram"></a>

## Acknowledgements

This work was initially sponsored by a joint grant from [PSE](https://pse.dev/) and [0xPARC](https://0xparc.org/). It is currently incubated by PSE.